import{c as Z,n as F,t as me,u as oe,e as ee,i as z,I as Q,w as te,a4 as ve,_ as Ce,l as Ke,T as He,a5 as Ue,m as H,y as Ye,v as Se,a6 as Xe,a as Je,j as ce,f as ue,a7 as ye,a8 as Qe,p as le,a9 as Ze,aa as et,r as tt,b as nt,V as at,z as ot,W as it,N as de,G as fe,h as lt,a3 as ct,D as _e}from"./index.f0899187.js";import{u as Ie,T as rt,a as st}from"./index.27da6a18.js";import"./index.8e571ece.js";import{e as ne,d as i,s as Te,r as L,f as B,l as ut,w as ge,n as X,j as we,q as Ae,R as dt,m as ft,_ as Ve,A as Ee,o as P,c as D,Q as $e,b as Re,F as J,D as ie,C as he,B as gt,K as Pe,z as ht}from"./index.1d9da499.js";import{u as Be}from"./city.74273b9f.js";import{r as mt,u as vt}from"./use-route.917c1983.js";const[bt,K]=Z("cell"),Le={icon:String,size:String,title:F,value:F,label:F,center:Boolean,isLink:Boolean,border:me,required:Boolean,iconPrefix:String,valueClass:oe,labelClass:oe,titleClass:oe,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},yt=ee({},Le,mt);var _t=ne({name:bt,props:yt,setup(e,{slots:n}){const a=vt(),s=()=>{if(n.label||z(e.label))return i("div",{class:[K("label"),e.labelClass]},[n.label?n.label():e.label])},l=()=>{if(n.title||z(e.title))return i("div",{class:[K("title"),e.titleClass],style:e.titleStyle},[n.title?n.title():i("span",null,[e.title]),s()])},u=()=>{const o=n.value||n.default;if(o||z(e.value)){const c=n.title||z(e.title);return i("div",{class:[K("value",{alone:!c}),e.valueClass]},[o?o():i("span",null,[e.value])])}},m=()=>{if(n.icon)return n.icon();if(e.icon)return i(Q,{name:e.icon,class:K("left-icon"),classPrefix:e.iconPrefix},null)},v=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const o=e.arrowDirection?`arrow-${e.arrowDirection}`:"arrow";return i(Q,{name:o,class:K("right-icon")},null)}};return()=>{var o,h;const{size:c,center:w,border:I,isLink:b,required:_}=e,k=(o=e.clickable)!=null?o:b,A={center:w,required:_,clickable:k,borderless:!I};return c&&(A[c]=!!c),i("div",{class:K(A),role:k?"button":void 0,tabindex:k?0:void 0,onClick:a},[m(),l(),u(),v(),(h=n.extra)==null?void 0:h.call(n)])}}});const Me=te(_t);function Oe(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function xt(e,n){if(Oe(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function kt(e,n){return new Promise(a=>{const s=n.validator(e,n);if(He(s)){s.then(a);return}a(s)})}function xe(e,n){const{message:a}=n;return Ue(a)?a(e,n):a||""}function Ct({target:e}){e.composing=!0}function ke({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function St(e,n){const a=ve();e.style.height="auto";let s=e.scrollHeight;if(Ke(n)){const{maxHeight:l,minHeight:u}=n;l!==void 0&&(s=Math.min(s,l)),u!==void 0&&(s=Math.max(s,u))}s&&(e.style.height=`${s}px`,Ce(a))}function It(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function re(e){return[...e].length}function Tt(e,n){return[...e].slice(0,n).join("")}const[wt,V]=Z("field"),be={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:F,formatter:Function,clearIcon:H("clear"),modelValue:Ye(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:H("focus"),formatTrigger:H("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},At=ee({},Le,be,{rows:F,type:H("text"),rules:Array,autosize:[Boolean,Object],labelWidth:F,labelClass:oe,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Vt=ne({name:wt,props:At,emits:["blur","focus","clear","keypress","click-input","end-validate","start-validate","click-left-icon","click-right-icon","update:modelValue"],setup(e,{emit:n,slots:a}){const s=Ie(),l=Te({status:"unvalidated",focused:!1,validateMessage:""}),u=L(),m=L(),v=L(),{parent:o}=Se(Xe),h=()=>{var t;return String((t=e.modelValue)!=null?t:"")},c=t=>{if(z(e[t]))return e[t];if(o&&z(o.props[t]))return o.props[t]},w=B(()=>{const t=c("readonly");if(e.clearable&&!t){const f=h()!=="",g=e.clearTrigger==="always"||e.clearTrigger==="focus"&&l.focused;return f&&g}return!1}),I=B(()=>v.value&&a.input?v.value():e.modelValue),b=t=>t.reduce((f,g)=>f.then(()=>{if(l.status==="failed")return;let{value:T}=I;if(g.formatter&&(T=g.formatter(T,g)),!xt(T,g)){l.status="failed",l.validateMessage=xe(T,g);return}if(g.validator)return Oe(T)&&g.validateEmpty===!1?void 0:kt(T,g).then(G=>{G&&typeof G=="string"?(l.status="failed",l.validateMessage=G):G===!1&&(l.status="failed",l.validateMessage=xe(T,g))})}),Promise.resolve()),_=()=>{l.status="unvalidated",l.validateMessage=""},k=()=>n("end-validate",{status:l.status}),A=(t=e.rules)=>new Promise(f=>{_(),t?(n("start-validate"),b(t).then(()=>{l.status==="failed"?(f({name:e.name,message:l.validateMessage}),k()):(l.status="passed",f(),k())})):f()}),N=t=>{if(o&&e.rules){const{validateTrigger:f}=o.props,g=ye(f).includes(t),T=e.rules.filter(G=>G.trigger?ye(G.trigger).includes(t):g);T.length&&A(T)}},W=t=>{const{maxlength:f}=e;if(z(f)&&re(t)>f){const g=h();return g&&re(g)===+f?g:Tt(t,+f)}return t},M=(t,f="onChange")=>{if(t=W(t),e.type==="number"||e.type==="digit"){const g=e.type==="number";t=Qe(t,g,g)}e.formatter&&f===e.formatTrigger&&(t=e.formatter(t)),u.value&&u.value.value!==t&&(u.value.value=t),t!==e.modelValue&&n("update:modelValue",t)},U=t=>{t.target.composing||M(t.target.value)},r=()=>{var t;return(t=u.value)==null?void 0:t.blur()},q=()=>{var t;return(t=u.value)==null?void 0:t.focus()},O=()=>{const t=u.value;e.type==="textarea"&&e.autosize&&t&&St(t,e.autosize)},d=t=>{l.focused=!0,n("focus",t),X(O),c("readonly")&&r()},y=t=>{c("readonly")||(l.focused=!1,M(h(),"onBlur"),n("blur",t),N("onBlur"),X(O),et())},x=t=>n("click-input",t),S=t=>n("click-left-icon",t),C=t=>n("click-right-icon",t),$=t=>{le(t),n("update:modelValue",""),n("clear",t)},p=B(()=>{if(typeof e.error=="boolean")return e.error;if(o&&o.props.showError&&l.status==="failed")return!0}),R=B(()=>{const t=c("labelWidth");if(t)return{width:Je(t)}}),E=t=>{t.keyCode===13&&(!(o&&o.props.submitOnEnter)&&e.type!=="textarea"&&le(t),e.type==="search"&&r()),n("keypress",t)},ae=()=>e.id||`${s}-input`,j=()=>l.status,De=()=>{const t=V("control",[c("inputAlign"),{error:p.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return i("div",{class:t,onClick:x},[a.input()]);const f={id:ae(),ref:u,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:c("disabled"),readonly:c("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,enterkeyhint:e.enterkeyhint,"aria-labelledby":e.label?`${s}-label`:void 0,onBlur:y,onFocus:d,onInput:U,onClick:x,onChange:ke,onKeypress:E,onCompositionend:ke,onCompositionstart:Ct};return e.type==="textarea"?i("textarea",f,null):i("input",Ae(It(e.type),f),null)},ze=()=>{const t=a["left-icon"];if(e.leftIcon||t)return i("div",{class:V("left-icon"),onClick:S},[t?t():i(Q,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Fe=()=>{const t=a["right-icon"];if(e.rightIcon||t)return i("div",{class:V("right-icon"),onClick:C},[t?t():i(Q,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},je=()=>{if(e.showWordLimit&&e.maxlength){const t=re(h());return i("div",{class:V("word-limit")},[i("span",{class:V("word-num")},[t]),dt("/"),e.maxlength])}},Ge=()=>{if(o&&o.props.showErrorMessage===!1)return;const t=e.errorMessage||l.validateMessage;if(t){const f=a["error-message"],g=c("errorMessageAlign");return i("div",{class:V("error-message",g)},[f?f({message:t}):t])}},We=()=>{const t=c("colon")?":":"";if(a.label)return[a.label(),t];if(e.label)return i("label",{id:`${s}-label`,for:ae()},[e.label+t])},qe=()=>[i("div",{class:V("body")},[De(),w.value&&i(Q,{ref:m,name:e.clearIcon,class:V("clear")},null),Fe(),a.button&&i("div",{class:V("button")},[a.button()])]),je(),Ge()];return ce({blur:r,focus:q,validate:A,formValue:I,resetValidation:_,getValidationStatus:j}),ut(Ze,{customValue:v,resetValidation:_,validateWithTrigger:N}),ge(()=>e.modelValue,()=>{M(h()),_(),N("onChange"),X(O)}),we(()=>{M(h(),e.formatTrigger),X(O)}),ue("touchstart",$,{target:B(()=>{var t;return(t=m.value)==null?void 0:t.$el})}),()=>{const t=c("disabled"),f=c("labelAlign"),g=We(),T=ze();return i(Me,{size:e.size,icon:e.leftIcon,class:V({error:p.value,disabled:t,[`label-${f}`]:f}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:R.value,valueClass:V("value"),titleClass:[V("label",[f,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:T?()=>T:null,title:g?()=>g:null,value:qe,extra:a.extra})}}});const Et=te(Vt);function $t(){const e="A".charCodeAt(0);return Array(26).fill("").map((a,s)=>String.fromCharCode(e+s))}const[pe,se]=Z("index-bar"),Rt={sticky:me,zIndex:F,teleport:[String,Object],highlightColor:String,stickyOffsetTop:tt(0),indexList:{type:Array,default:$t}},Ne=Symbol(pe);var Pt=ne({name:pe,props:Rt,emits:["select","change"],setup(e,{emit:n,slots:a}){const s=L(),l=L(),u=L(""),m=nt(),v=at(s),{children:o,linkChildren:h}=ot(Ne);let c;h({props:e});const w=B(()=>{if(z(e.zIndex))return{zIndex:+e.zIndex+1}}),I=B(()=>{if(e.highlightColor)return{color:e.highlightColor}}),b=(d,y)=>{for(let x=o.length-1;x>=0;x--){const S=x>0?y[x-1].height:0,C=e.sticky?S+e.stickyOffsetTop:0;if(d+C>=y[x].top)return x}return-1},_=d=>o.find(y=>String(y.index)===d),k=()=>{if(it(s))return;const{sticky:d,indexList:y}=e,x=de(v.value),S=fe(v),C=o.map(p=>p.getRect(v.value,S));let $=-1;if(c){const p=_(c);if(p){const R=p.getRect(v.value,S);$=b(R.top,C)}}else $=b(x,C);u.value=y[$],d&&o.forEach((p,R)=>{const{state:E,$el:ae}=p;if(R===$||R===$-1){const j=ae.getBoundingClientRect();E.left=j.left,E.width=j.width}else E.left=null,E.width=null;if(R===$)E.active=!0,E.top=Math.max(e.stickyOffsetTop,C[R].top-x)+S.top;else if(R===$-1&&c===""){const j=C[$].top-x;E.active=j>0,E.top=j+S.top-C[R].height}else E.active=!1}),c=""},A=()=>{X(k)};ue("scroll",k,{target:v,passive:!0}),we(A),ge(()=>e.indexList,A),ge(u,d=>{d&&n("change",d)});const N=()=>e.indexList.map(d=>{const y=d===u.value;return i("span",{class:se("index",{active:y}),style:y?I.value:void 0,"data-index":d},[d])}),W=d=>{c=String(d);const y=_(c);if(y){const x=de(v.value),S=fe(v),{offsetHeight:C}=document.documentElement;if(y.$el.scrollIntoView(),x===C-S.height){k();return}e.sticky&&e.stickyOffsetTop&&Ce(ve()-e.stickyOffsetTop),n("select",y.index)}},M=d=>{const{index:y}=d.dataset;y&&W(y)},U=d=>{M(d.target)};let r;const q=d=>{if(m.move(d),m.isVertical()){le(d);const{clientX:y,clientY:x}=d.touches[0],S=document.elementFromPoint(y,x);if(S){const{index:C}=S.dataset;C&&r!==C&&(r=C,M(S))}}},O=()=>i("div",{ref:l,class:se("sidebar"),style:w.value,onClick:U,onTouchstartPassive:m.start},[N()]);return ce({scrollTo:W}),ue("touchmove",q,{target:l}),()=>{var d;return i("div",{ref:s,class:se()},[e.teleport?i(ft,{to:e.teleport},{default:()=>[O()]}):O(),(d=a.default)==null?void 0:d.call(a)])}}});const[Bt,Lt]=Z("index-anchor"),Mt={index:F};var Ot=ne({name:Bt,props:Mt,setup(e,{slots:n}){const a=Te({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),s=L(),{parent:l}=Se(Ne);if(!l)return;const u=()=>a.active&&l.props.sticky,m=B(()=>{const{zIndex:o,highlightColor:h}=l.props;if(u())return ee(lt(o),{left:a.left?`${a.left}px`:void 0,width:a.width?`${a.width}px`:void 0,transform:a.top?`translate3d(0, ${a.top}px, 0)`:void 0,color:h})});return ce({state:a,getRect:(o,h)=>{const c=fe(s);return a.rect.height=c.height,o===window||o===document.body?a.rect.top=c.top+ve():a.rect.top=c.top+de(o)-h.top,a.rect}}),()=>{const o=u();return i("div",{ref:s,style:{height:o?`${a.rect.height}px`:void 0}},[i("div",{style:m.value,class:[Lt({sticky:o}),{[ct]:o}]},[n.default?n.default():e.index])])}}});const pt=te(Ot),Nt=te(Pt),[Dt,Y,zt]=Z("search"),Ft=ee({},be,{label:String,shape:H("square"),leftIcon:H("search"),clearable:me,actionText:String,background:String,showAction:Boolean});var jt=ne({name:Dt,props:Ft,emits:["blur","focus","clear","search","cancel","click-input","click-left-icon","click-right-icon","update:modelValue"],setup(e,{emit:n,slots:a,attrs:s}){const l=Ie(),u=L(),m=()=>{a.action||(n("update:modelValue",""),n("cancel"))},v=r=>{r.keyCode===13&&(le(r),n("search",e.modelValue))},o=()=>e.id||`${l}-input`,h=()=>{if(a.label||e.label)return i("label",{class:Y("label"),for:o()},[a.label?a.label():e.label])},c=()=>{if(e.showAction){const r=e.actionText||zt("cancel");return i("div",{class:Y("action"),role:"button",tabindex:0,onClick:m},[a.action?a.action():r])}},w=()=>{var r;return(r=u.value)==null?void 0:r.blur()},I=()=>{var r;return(r=u.value)==null?void 0:r.focus()},b=r=>n("blur",r),_=r=>n("focus",r),k=r=>n("clear",r),A=r=>n("click-input",r),N=r=>n("click-left-icon",r),W=r=>n("click-right-icon",r),M=Object.keys(be),U=()=>{const r=ee({},s,_e(e,M),{id:o()}),q=O=>n("update:modelValue",O);return i(Et,Ae({ref:u,type:"search",class:Y("field"),border:!1,onBlur:b,onFocus:_,onClear:k,onKeypress:v,"onClick-input":A,"onClick-left-icon":N,"onClick-right-icon":W,"onUpdate:modelValue":q},r),_e(a,["left-icon","right-icon"]))};return ce({focus:I,blur:w}),()=>{var r;return i("div",{class:Y({"show-action":e.showAction}),style:{background:e.background}},[(r=a.left)==null?void 0:r.call(a),i("div",{class:Y("content",e.shape)},[h(),U()]),c()])}}});const Gt=te(jt);const Wt={class:"city"},qt={class:"hot"},Kt=["onClick"],Ht={__name:"city-box",props:{currentGroup:{type:Object,default:()=>({})}},setup(e){const n=e,a=Be(),s=B(()=>{var v;const m=(v=n.currentGroup.cities)==null?void 0:v.map(o=>o.group);return m==null||m.unshift("#"),m}),l=Ee(),u=m=>{a.showCity=m,l.back()};return(m,v)=>{const o=pt,h=Me,c=Nt;return P(),D("div",Wt,[i(c,{sticky:!1,"index-list":he(s)},{default:$e(()=>{var w,I;return[i(o,{index:"\u70ED\u95E8"}),Re("div",qt,[(P(!0),D(J,null,ie((w=e.currentGroup)==null?void 0:w.hotCities,b=>(P(),D("div",{key:b.cityId,onClick:_=>u(b),class:"hot-item"},gt(b.cityName),9,Kt))),128))]),(P(!0),D(J,null,ie((I=e.currentGroup)==null?void 0:I.cities,(b,_)=>(P(),D(J,{key:_},[i(o,{index:b.group},null,8,["index"]),(P(!0),D(J,null,ie(b.cities,(k,A)=>(P(),Pe(h,{key:A,title:k.cityName,onClick:N=>u(k)},null,8,["title","onClick"]))),128))],64))),128))]}),_:1},8,["index-list"])])}}},Ut=Ve(Ht,[["__scopeId","data-v-3c65dfe4"]]);const Yt={class:"city"},Xt={class:"box"},Jt={__name:"home-city",setup(e){const n=Be();n.cityAllAction();const{cityAll:a}=ht(n),s=Ee(),l=L(""),u=L(""),m=()=>{s.back()},v=B(()=>a.value[u.value]);return(o,h)=>{const c=Gt,w=rt,I=st;return P(),D("div",Yt,[i(c,{onCancel:m,"show-action":"",modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=b=>l.value=b),placeholder:"\u57CE\u5E02/\u533A\u57DF/\u4F4D\u7F6E",shape:"round"},null,8,["modelValue"]),i(I,{active:u.value,"onUpdate:active":h[1]||(h[1]=b=>u.value=b),color:"#ff9645"},{default:$e(()=>[(P(!0),D(J,null,ie(he(a),(b,_,k)=>(P(),Pe(w,{key:_,title:b.title,name:_},null,8,["title","name"]))),128))]),_:1},8,["active"]),Re("div",Xt,[i(Ut,{currentGroup:he(v)},null,8,["currentGroup"])])])}}},on=Ve(Jt,[["__scopeId","data-v-9e3ad8ea"]]);export{on as default};
